@let tracker = $tracker();

<ion-card>
	<ion-item color="light">
		<ion-label>
			<ion-text class="ion-padding-end" color="medium">Record for:</ion-text>
			<b>myself</b>
		</ion-label>
	</ion-item>
	<ion-item>
		<ion-input
			#numberInput
			type="number"
			[disabled]="$isSubmitting()"
			label="{{ tracker?.brief?.emoji }} {{ tracker?.brief?.title }}"
			(keyup.enter)="addTrackerRecord()"
		/>
		<ion-buttons slot="end">
			<ion-button
				fill="solid"
				color="primary"
				[disabled]="$isSubmitting() || numberInput.value === ''"
				(click)="addTrackerRecord()"
			>
				<ion-icon name="add-outline" slot="start" />
				<ion-label>Add entry</ion-label>
			</ion-button>
		</ion-buttons>
	</ion-item>
</ion-card>

<ion-card>
	<!--	<ion-segment [value]="$selectedTargetKey()" (ionChange)="onSelectedTargetKeyChanged($event)">-->
	<!--		@for (targetKey of $targetKeys(); track targetKey) {-->
	<!--			<ion-segment-button [value]="targetKey">-->
	<!--				<ion-label>{{ targetKey }}</ion-label>-->
	<!--			</ion-segment-button>-->
	<!--		}-->
	<!--	</ion-segment>-->

	@for (date of $entriesByDate(); track date.dateID) {
		<ion-item-divider color="light">
			<ion-label>{{ date.dateID }}</ion-label>
		</ion-item-divider>
		<ion-item>
			<ion-label>
				{{ $selectedTargetKey() }}
				@for (entry of date.entries; track entry.t; let isLast = $last) {
					<ion-chip style="padding-right: 0 !important">
						<ion-label
							style="font-weight: bold"
							title="Added at {{ entry.t.toDate() | date: 'HH:mm' }}"
						>
							{{ entry.i }}
						</ion-label>
						<ion-buttons>
							<ion-button
								title="Delete record"
								(click)="deleteTrackerRecord($selectedTargetKey(), entry.t)"
							>
								<ion-icon name="close-outline" color="medium" />
							</ion-button>
						</ion-buttons>
					</ion-chip>
					@if (!isLast) {
						+
					}
				}
				@if (date.entries.length > 1) {
					= <ion-chip color="secondary">12</ion-chip>
				}
			</ion-label>
		</ion-item>
	}
</ion-card>
